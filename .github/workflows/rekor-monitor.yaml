name: Rekor Monitor

on:
 schedule:
   - cron: '0 * * * *' # hourly

jobs:
  run-consistency-proof:
    permissions:
      contents: read
      issues: write
      id-token: write
    uses: sigstore/rekor-monitor/.github/workflows/reusable_monitoring.yml@b3b5cb9ee132ff15f784b1b4c00413766a3faaca
    with:
      file_issue: true
      artifact_retention_days: 14
      identities: |
        certIdentities:
          - certSubject: ^${{ github.server_url }}/${{ github.repository }}/\.github/workflows/build-and-push\.yaml@.*
            issuers:
              - https://token.actions.githubusercontent.com
          - certSubject: ^${{ github.server_url }}/${{ github.repository }}/\.github/workflows/scan-image\.yaml@.*
            issuers:
              - https://token.actions.githubusercontent.com
          - certSubject: ^${{ github.server_url }}/${{ github.repository }}/\.github/workflows/policy-verification\.yaml@.*
            issuers:
              - https://token.actions.githubusercontent.com
